---
title: "britton_a_assignment5"
author: "Annie Britton"
date: "2/19/2023"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## PART IV: FAO and Agriculture (10 points)
```{r message=FALSE, warning=FALSE}
# Load in the tidyverse
library(tidyverse)

# Set my working directory
setwd("C:\\Users\\annie\\Documents\\AEEN\\M05")

# Load in the data
load("FAOData.RData")
```

### View the datasets.
```{r}
head(dat1l2, 3)
```
```{r}
head(dat1l2, 3)
```
```{r}
head(dat1w, 3)
```
```{r}
head(dat2, 3)
```
```{r}
head(dat2c, 3)
```

### Generate a point plot of crop yield as a function of year using the dat1l data frame.
```{r}
# Use ggplot to generate a point plot using geom_point
ggplot() + geom_point(data = dat1l, aes(x = Year, y = Yield))
```

### Letâ€™s include a third variable, crop type, to the map. You will need to map its aesthetics: so map Crop to the color element of the geom. Note how color acts as a grouping parameter.
```{r}
# Add color to the point plot by crop by adding color = Crop into geom_point
ggplot() + geom_point(data = dat1l, aes(x = Year, y = Yield, color = Crop))
```

### Now plot lines instead of points, by substituting the geometry type with the geom_line() geometry.
```{r}
# Change the points to lines by using the geom_line function
ggplot() + geom_line(data = dat1l, aes(x = Year, y = Yield, color = Crop))
```

### Use data from dat1w to generate a plot of oat yield as a function of year.
```{r}
# Use geom_line to generate a line plot of oat yeilds by year
ggplot() + geom_line(data = dat1w, aes(x = Year, y = Oats))
```

### Modify the color and line type of this plot.
```{r}
# change the line type to dashed using linetype and color to brown
ggplot() + geom_line(data = dat1w, aes(x = Year, y = Oats), linetype = "dashed", color='brown')
```

## PART V: More ggplot2 using LPI  (10 points)
```{r message=FALSE, warning=FALSE}
# Import data from the Living Planet Index - population trends of vertebrate species from 1970 to 2014
LPI <- read_csv('LPIdata_CC.csv')

# View the data
head(LPI)
```
### First, we need to get our data loaded and in the right format. 
```{r}
# Notice the data are in a wide format - the different years are column names, when really they should be rows
# We will reshape the data using the gather() function from the tidyr package
# Reshape data into long form 
# By adding 9:53, we select rows from 9 to 53, the ones for the different years of monitoring
LPI2 <- gather(LPI, "year", "abundance", 9:53)
glimpse(LPI2)
```
```{r}
# Notice that there is an 'X' in front of all the years - when we imported the data, all column names become characters
# R put an 'X' in front of the years to turn the numbers into characters
# Now that the years are rows, not columns, we need them to be numbers
LPI2$year <- as.numeric(LPI2$year)
```
```{r}
# When manipulating data, it's always good to check if the variables have stayed how we want them
# Use the str() function
str(LPI2)
```
```{r warning=FALSE}
# Abundance is a character variable, when it should be numeric, let's fix that
LPI2$abundance <- as.numeric(LPI2$abundance)
str(LPI2)
```

### Create a graph of population trends of two species of your choice.
```{r message=FALSE}
# Select the two species of interest
my_species <- filter(LPI2, `Common Name` == c("Bald eagle", "Pink salmon"))

# Group the species by common name and year, and then find the total abundance
my_species <- my_species %>% group_by(`Common Name`, year) %>% summarize(total_abun = sum(abundance, na.rm=TRUE))

# Plot the species on a line plot using Common Name to distinguish the colors
ggplot() + 
  geom_line(data = my_species, 
            aes(x = year, 
                y = total_abun, 
                color = `Common Name`)) +
  ylab("Total Abundance")

```

### Choose two species from the LPI data and display their population trends using a boxplot
```{r message=FALSE}
# Select the two species of interest
my_species <- filter(LPI2, `Common Name` == c("Chinook salmon", "Sockeye salmon / Red salmon"))

# Group the species by common name and year, and then find the total abundance
my_species <- my_species %>% group_by(`Common Name`, year) %>% summarize(total_abun = sum(abundance, na.rm=TRUE))

# Plot the species on a box plot showing total abundance
ggplot() + 
  geom_boxplot(data = my_species, 
            aes(x = `Common Name`, 
                y = total_abun, fill= `Common Name`)) +
  ylab("Total Abundance") + 
  theme(legend.position="bottom")
```